<!DOCTYPE html><meta charset="utf-8"><script type="module" src="/_astro/page.EDj8xPHu.js"></script><h1 id="compress️"><a href="HTTPS://NPMJS.Org/astro-compress">Compress</a> 🗜️</h1>
<p>This <strong><a href="HTTPS://docs.astro.build/en/guides/integrations-guide/"><code>Astro integration</code></a></strong> brings compression utilities
to your Astro project.</p>
<p><a href="HTTPS://NPMJS.Org/csso"><code>CSS (csso)</code></a> 🎁</p>
<p><a href="HTTPS://NPMJS.Org/lightningcss"><code>CSS (lightningcss)</code></a> 🎁</p>
<p><a href="HTTPS://NPMJS.Org/html-minifier-terser"><code>HTML (html-minifier-terser)</code></a> 🎁</p>
<p><a href="HTTPS://NPMJS.Org/sharp"><code>Image (sharp)</code></a> 🎁</p>
<p><a href="HTTPS://NPMJS.Org/terser"><code>JavaScript (terser)</code></a> 🎁</p>
<p><a href="HTTPS://NPMJS.Org/svgo"><code>SVG (svgo)</code></a> 🎁</p>
<blockquote>
<p><strong>Note</strong></p>
<p><code>Compress</code> will not compress your requests, only your statically generated
build and pre-rendered routes.</p>
</blockquote>
<blockquote>
<p>[!IMPORTANT]</p>
<p>Use <code>Compress</code> last in your integration list for the best optimizations.</p>
</blockquote>
<h2 id="installation">Installation 🚀</h2>
<p>There are two ways to add integrations to your project. Let’s try the most
convenient option first!</p>
<h3 id="astro-add-command"><code>astro add</code> command</h3>
<p>Astro includes a CLI tool for adding first party integrations: <code>astro add</code>. This
command will:</p>
<ol>
<li>(Optionally) Install all necessary dependencies and peer dependencies</li>
<li>(Also optionally) Update your <code>astro.config.*</code> file to apply this integration</li>
</ol>
<p>To install <code>Compress</code>, run the following from your project directory and follow
the prompts:</p>
<p>Using NPM:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">npx</span><span style="color:#9ECBFF"> astro</span><span style="color:#9ECBFF"> add</span><span style="color:#9ECBFF"> astro-compress</span></span></code></pre>
<p>Using Yarn:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">yarn</span><span style="color:#9ECBFF"> astro</span><span style="color:#9ECBFF"> add</span><span style="color:#9ECBFF"> astro-compress</span></span></code></pre>
<p>Using PNPM:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">pnpx</span><span style="color:#9ECBFF"> astro</span><span style="color:#9ECBFF"> add</span><span style="color:#9ECBFF"> astro-compress</span></span></code></pre>
<h3 id="install-dependencies-manually">Install dependencies manually</h3>
<p>First, install the <code>Compress</code> integration like so:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> install</span><span style="color:#79B8FF"> -D</span><span style="color:#79B8FF"> -E</span><span style="color:#9ECBFF"> astro-compress</span></span></code></pre>
<p>Then, apply this integration to your <code>astro.config.*</code> file using the
<code>integrations</code> property:</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">()],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h2 id="getting-started">Getting started</h2>
<p>The utility will now automatically compress all your CSS, HTML, SVG, JavaScript
and image files in the Astro <code>outDir</code> folder.</p>
<p>The following image file types will be compressed via <a href="HTTPS://NPMJS.Org/sharp">sharp</a>:</p>
<ul>
<li>avci</li>
<li>avcs</li>
<li>avif</li>
<li>avifs</li>
<li>gif</li>
<li>heic</li>
<li>heics</li>
<li>heif</li>
<li>heifs</li>
<li>jfif</li>
<li>jif</li>
<li>jpe</li>
<li>jpeg</li>
<li>jpg</li>
<li>apng</li>
<li>png</li>
<li>raw</li>
<li>tiff</li>
<li>webp</li>
</ul>
<p>SVG compression is supported, as well via <a href="HTTPS://NPMJS.Org/svgo">svgo</a>.</p>
<h3 id="default-compression">Default Compression</h3>
<p>You can override any of the default options from the configurations of:</p>
<ul>
<li><a href="HTTPS://GitHub.Com/css/csso#minifysource-options"><code>csso</code></a></li>
<li><a href="HTTPS://GitHub.Com/parcel-bundler/lightningcss/blob/master/node/index.d.ts#L8"><code>lightningcss</code></a></li>
<li><a href="HTTPS://GitHub.Com/terser/html-minifier-terser#options-quick-reference"><code>html-minifier-terser</code></a></li>
<li><a href="https://sharp.pixelplumbing.com/api-output#jpeg"><code>sharp</code></a></li>
<li><a href="HTTPS://GitHub.Com/svg/svgo#configuration"><code>svgo</code></a></li>
<li><a href="HTTPS://GitHub.Com/terser/terser#minify-options-structure"><code>terser</code></a></li>
</ul>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			CSS: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			HTML: {</span></span>
<span class="line"><span style="color:#9ECBFF">				"html-minifier-terser"</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#E1E4E8">					removeAttributeQuotes: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">				},</span></span>
<span class="line"><span style="color:#E1E4E8">			},</span></span>
<span class="line"><span style="color:#E1E4E8">			Image: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			JavaScript: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			SVG: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<p>or disable them entirely:</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			CSS: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			HTML: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			Image: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			JavaScript: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			SVG: </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<p>You can see the full option map here:
<a href="HTTPS://GitHub.Com/PlayForm/Compress/blob/main/Source/Interface/Option.ts"><code>Source/Interface/Option.ts</code></a></p>
<h3 id="output">Output</h3>
<p>By default <code>Compress</code> compresses the <code>outDir</code> <code>Astro</code> directory, if you’d like
it to compress a different directory you would have to add it to the <code>Compress</code>
<code>Path</code> option, as well:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Path: [</span><span style="color:#9ECBFF">"./dist"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"./Compress"</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="add-multiple-paths">Add Multiple Paths</h3>
<p>You can add multiple paths to compress by specifying an array as the <code>Path</code>
variable.</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Path: [</span><span style="color:#9ECBFF">"./Target"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"./Build"</span><span style="color:#E1E4E8">],</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="input-output-mapping">Input-Output Mapping</h3>
<p>You can also provide a map of paths for different input output directories.</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Path: </span><span style="color:#F97583">new</span><span style="color:#B392F0"> Map</span><span style="color:#E1E4E8">([[</span><span style="color:#9ECBFF">"./Source"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"./Target"</span><span style="color:#E1E4E8">]]),</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<p>Or an array of the two:</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Path: [</span></span>
<span class="line"><span style="color:#6A737D">				// Compress Target</span></span>
<span class="line"><span style="color:#9ECBFF">				"./Target"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#6A737D">				// Compress Target one more time into a different directory</span></span>
<span class="line"><span style="color:#F97583">				new</span><span style="color:#B392F0"> Map</span><span style="color:#E1E4E8">([[</span><span style="color:#9ECBFF">"./Target"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"./TargetCompress"</span><span style="color:#E1E4E8">]]),</span></span>
<span class="line"><span style="color:#E1E4E8">			],</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="file-filtering">File Filtering</h3>
<p>You can filter files to exclude specific ones from compression. A filter can be
an array of regular expressions or a single match. You can also use functions to
match on file names:</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Exclude: [</span></span>
<span class="line"><span style="color:#9ECBFF">				"File.png"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">				(</span><span style="color:#FFAB70">File</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span></span>
<span class="line"><span style="color:#E1E4E8">					File </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> "./Target/Favicon/Image/safari-pinned-tab.svg"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">			],</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="controlling-logging">Controlling Logging</h3>
<p>You can control the logging level by setting the <code>Logger</code> parameter. The default
value is <code>2</code>, but you can set it to <code>0</code> if you don’t want to see debug messages:</p>
<p><strong><code>astro.config.ts</code></strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	integrations: [</span></span>
<span class="line"><span style="color:#E1E4E8">		(</span><span style="color:#F97583">await</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"astro-compress"</span><span style="color:#E1E4E8">)).</span><span style="color:#B392F0">default</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">			Logger: </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">		}),</span></span>
<span class="line"><span style="color:#E1E4E8">	],</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h2 id="changelog">Changelog</h2>
<p>See <a href="CHANGELOG.md"><code>CHANGELOG.md</code></a> for a history of changes to this integration.</p>